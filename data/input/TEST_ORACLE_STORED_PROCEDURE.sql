create or replace procedure ORDDATA.Employee AS
BEGIN
   EXECUTE IMMEDIATE 'create table ORDDATA.EMPLOYEE_DETAIL(
    EMPLOYEE_ID VARCHAR2(50) NOT NULL,
    EMPLOYEE_FIRST_NAME VARCHAR2(50) NOT NULL,
    EMPLOYEE_LAST_NAME VARCHAR2(50) NOT NULL,
    PRIMARY KEY(EMPLOYEE_ID))';
    
    EXECUTE IMMEDIATE 'create table ORDDATA.Designation(
    EMPLOYEE_ID NUMBER,
    EMPLOYEE_DESIGNATION VARCHAR2(50) NOT NULL,
    PRIMARY KEY(EMPLOYEE_ID))';

  -- Insert data into the table
  EXECUTE IMMEDIATE 'INSERT INTO ORDDATA.EMPLOYEE_DETAIL (EMPLOYEE_ID, EMPLOYEE_FIRST_NAME, EMPLOYEE_LAST_NAME) VALUES (01, ''Uday'', ''Hegde'')';
  EXECUTE IMMEDIATE 'INSERT INTO ORDDATA.EMPLOYEE_DETAIL (EMPLOYEE_ID, EMPLOYEE_FIRST_NAME, EMPLOYEE_LAST_NAME) VALUES (02, ''Lalit'', ''Bakshi'')';
  EXECUTE IMMEDIATE 'INSERT INTO ORDDATA.EMPLOYEE_DETAIL (EMPLOYEE_ID, EMPLOYEE_FIRST_NAME, EMPLOYEE_LAST_NAME) VALUES (03, ''Shridhar'', ''Bhatt'')';
  
  EXECUTE IMMEDIATE 'INSERT INTO ORDDATA.Designation (EMPLOYEE_ID, EMPLOYEE_FIRST_NAME, EMPLOYEE_LAST_NAME) VALUES (01, ''CEO'')';
  EXECUTE IMMEDIATE 'INSERT INTO ORDDATA.Designation (EMPLOYEE_ID, EMPLOYEE_FIRST_NAME, EMPLOYEE_LAST_NAME) VALUES (02, ''PRESIDENT'')';
  EXECUTE IMMEDIATE 'INSERT INTO ORDDATA.Designation (EMPLOYEE_ID, EMPLOYEE_FIRST_NAME, EMPLOYEE_LAST_NAME) VALUES (03, ''SVP-HR'')';
  
  EXECUTE IMMEDIATE 'CREATE TABLE ORDDATA.Organization AS 
  SELECT  a.EMPLOYEE_ID
  ,a.EMPLOYEE_FIRST_NAME
  ,a.EMPLOYEE_LAST_NAME
  ,EMPLOYEE_DESIGNATION
  from ORDDATA.EMPLOYEE_DETAIL a
  JOIN ORDDATA.Designation b
  on a.EMPLOYEE_ID=b.EMPLOYEE_ID';
  
  COMMIT;

  -- Output message
  DBMS_OUTPUT.PUT_LINE('Tables created, data loaded, and joined successfully.');
EXCEPTION
  WHEN OTHERS THEN
    -- Rollback transaction if there's an error
    ROLLBACK;
    -- Output error message
    DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
    RAISE;
END;