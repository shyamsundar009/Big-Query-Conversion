CREATE OR REPLACE PROCEDURE SP_CIN_CIGNA_DAILY_MATCHED
AS
begin
    insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'starting refresh');
    COMMIT;

    DELETE FROM CIN_CIGNA_DAILY_MATCHED;
    COMMIT;

    insert into CIN_CIGNA_DAILY_MATCHED
    -- CIGNA COMMERICAL TRANSITION
            SELECT /*+ INDEX (PATIENT PK_PATIENT) */ DISTINCT case when DAILY.FACILITY like '%NYU%' then 'NYU/HJD' else 'OTHER' End as NYU_OTHER,
            DAILY.PAT_MRN_ID,
            DAILY.PAT_ID,
            DAILY.DATE_ADDED AS DATE_ADDED,
            UPPER(CASE WHEN PAT.PAT_LAST_NAME IS NOT NULL THEN PAT.PAT_LAST_NAME ELSE DAILY.PATIENT_LAST_NAME END) AS PAT_LAST_NAME,
            UPPER(CASE WHEN PAT.PAT_FIRST_NAME IS NOT NULL THEN PAT.PAT_FIRST_NAME ELSE DAILY.PATIENT_FIRST_NAME END) AS PAT_FIRST_NAME,
            DAILY.GENDER,
            CASE WHEN PAT.BIRTH_DATE IS NOT NULL THEN TO_CHAR(PAT.BIRTH_DATE, 'MM/DD/YYYY') ELSE DAILY.DOB END AS DOB,
            DAILY.CIGNA_ID,
            DAILY.ALIGNED_PHYSICIAN_NAME,
            DAILY.POD_NAME,
            DAILY.SUBGROUP_LEVEL_1,
            DAILY.CUSTOM_NAME,
            DAILY.PRACTICE_LOCATION,
            DAILY.CIGNA_PHARMACY,
            DAILY.YHF,
            DAILY.IPHT,
            DAILY.CIGNA_BEHAVIORAL,
            DAILY.ACCOUNT_NAME,
            DAILY.ADMIT_DATE,
            DAILY.NEW_ENTRY_ON_REPORT,
            DAILY.PROJECTED_DISCHARGE_DATE,
            DAILY.ACTUAL_DISCHARGE_DATE,
            DAILY.LENGTH_OF_STAY,
            DAILY.DIAGNOSIS,
            DAILY.PROCEDURE,
            DAILY.ADMISSION_ACCESS_TYPE,
            DAILY.ADMISSION_ACCESS_DESCRIPTION,
            DAILY.BED_TYPE,
            DAILY.CASE_MANAGEMENT_PROGRAM,
            DAILY.FACILITY,
            DAILY.FACILITY_STATE,
            DAILY.ADMITTING_PROVIDER,
            DAILY.READMISSION,
            DAILY.INITIAL_REPORT_DATE,
            DAILY.AUTHORIZATION_NUMBER,
            DAILY.REFERRED_DATE,
            DAILY.REFERRAL_STATUS,
            DAILY.PRIMARY_DIAGNOSIS_DESC,
            DAILY.CASE_MANAGED_BY,
            DAILY.CASE_ID,
            DAILY.IDENTIFICATION_SOURCE,
            DAILY.ON_CURRENT_PREVISE,
            DAILY.ON_CURRENT_GIC,
            DAILY.TOT_MEDICAL_IN_PAST_12_MTH,
            DAILY.INPAT_PAST_12_MTH,
            DAILY.ER_VSTS_IN_LAST_12_MTH,
            DAILY.OUT_OF_NET_PAST_12_MTH,
            DAILY.ER_VST_FOR_SAM_DX_12_MTH,
            DAILY.NUM_OF_OFF_VSTS_12_MTH,
            DAILY.LAST_OFFICE_VISIT_DATE,
            DAILY.RX_PAST_12_MTH,
            DAILY.RX_PAST_3_MTH,
            DAILY.RX_PAST_3_MONTHS_1,
            DAILY.RX_PAST_3_MONTHS_2,
            DAILY.RX_PAST_3_MONTHS_3,
            DAILY.RX_PAST_3_MONTHS_4,
            DAILY.RX_PAST_3_MONTHS_5,
            DAILY.RX_PAST_3_MONTHS_6,
            DAILY.RX_PAST_3_MONTHS_7,
            DAILY.RX_PAST_3_MONTHS_8,
            DAILY.RX_PAST_3_MONTHS_9,
            DAILY.RX_PAST_3_MONTHS_10,
            DAILY.RX_PAST_3_MONTHS_11,
            DAILY.RX_PAST_3_MONTHS_12,
            TO_CHAR(NULL) AS TREATMT_SETTING_SUBTYPE, --THESE 4 ADDED BY GLENN FOR EXTRA UHC FIELDS
            TO_CHAR(NULL) AS RST_SCORE,
            TO_CHAR(NULL) AS DISP_CODE_DESC,
            TO_CHAR(NULL) AS RPM_SCORE,
            NULL AS PCMH_ATTR_EFFECTIVE_DATE,
            NULL AS PULSE_SCORE,
            NULL AS AOS_SCORE,
            NULL AS MEMBER_PHONE,
            'Commercial' AS LINE_OF_BUSINESS,
            NULL AS PRODUCT,
            NULL AS DEDICATED_UNIT_NAME,
            NULL AS STAY_TYPE,
            NULL AS AETNA_CARD_ID,
            CIN_GET_CURRENT_CCC(DAILY.PAT_ID) as CURRENT_CCC,
            'CIGNA' AS PAYOR,
            CASE WHEN DAILY.PAT_ID NOT IN (SELECT CIN_HISTORY_DAILY_WEBI.PAT_ID FROM CIN_HISTORY_DAILY_WEBI WHERE CIN_HISTORY_DAILY_WEBI.PAYOR = 'CIGNA' AND DAILY.ADMIT_DATE=CIN_HISTORY_DAILY_WEBI.ADMIT_DATE AND DAILY.ACTUAL_DISCHARGE_DATE=CIN_HISTORY_DAILY_WEBI.ACTUAL_DISCHARGE_DATE AND DAILY.PAT_ID=CIN_HISTORY_DAILY_WEBI.PAT_ID AND (CIN_HISTORY_DAILY_WEBI.DATE_RUN) < TRUNC(SYSDATE)) THEN 'Y' --Has not been on the webi before with this payor and admit date --cant use, havent kept history long enough yet -history has been there for a while now added 3/4/16
                 WHEN DAILY.CIGNA_ID IN (SELECT MEMBER_ID FROM CIN_CIGNA_DAILY_PT WHERE DATE_ADDED = TRUNC(SYSDATE) AND CIGNA_ID NOT IN (SELECT PT1.MEMBER_ID FROM CIN_CIGNA_DAILY_PT PT1, CIN_CIGNA_DAILY_PT PT2 WHERE PT1.DATE_ADDED = TRUNC(SYSDATE) AND PT1.MEMBER_ID = PT2.MEMBER_ID AND PT1.CONDITION = PT2.CONDITION AND PT1.DATE_ADDED-1 = PT2.DATE_ADDED)) THEN 'Y' --MEMBER_ID to cigna_id 9/19/16 by SC
                 ELSE 'N'
            END AS SEND_ONBASE_DOC,
            NULL AS AGE,
            NULL AS HOT_SPOTTER_CHRONIC,
            NULL AS HOT_SPOTTER_CHRONIC_MONTHS,
            NULL AS HOT_SPOTTER_READMISSION,
            NULL AS RISK_DRIVERS,
            NULL AS INPATIENT_AUTHORIZATION,
            NULL AS READMISSION_RISK,
            NULL AS CM_PROGRAM_STATUS,
            NULL AS CM_PROGRAM_STATUS_REASON,
            NULL AS DM_PROGRAM_NAME,
            NULL AS DM_PROGRAM_STATUS,
            NULL AS DM_PROGRAM_STATUS_REASON,
            NULL AS NEW_ATTRIBUTION,
            DAILY.NPI,
            NULL AS MONTHS_ATTRIBUTED,
            NULL AS ATTRIBUTION_METHOD,
            NULL AS ORGANIZATION,
            NULL AS PROSPECTIVE_RISK_SCORE,
            NULL AS CARE_OPPORTUNITIES,
            NULL AS CONDITIONS,
            NULL AS CONDITION_DETAILS,
            NULL AS VISITS,
            NULL AS ATTRIBUTED_PCP_LAST_VISIT_DATE,
            NULL AS ATTRIBUTED_PCP_NO_OF_VISITS,
            NULL AS ER_LAST_VISIT_DATE,
            NULL AS INPATIENT_LAST_VISIT_DATE,
            NULL AS INPATIENT_NO_OF_VISITS,
            NULL AS URGENT_CARE_LAST_VISIT_DATE,
            NULL AS URGENT_CARE_NO_OF_VISITS,
            NULL AS ACUTE_READMITS_LAST_30_DAYS,
            NULL AS ACUTE_ADMITS_LAST_12_MONTHS,
            --NULL AS HOT_SPOTTER_GAP_SCORE,
            NULL AS CMDM_CONTACT_NAME_PRI,
            NULL AS CMDM_CONTACT_PHONE_NO_PRI,
            NULL AS CMDM_CONTACT_NAME_SEC,
            NULL AS CMDM_CONTACT_PHONE_NO_SEC,
            NULL AS IHM_CARE_COORD_EMPLOYER,
            NULL AS OUTPATIENT_LAST_VISIT_DATE,
            NULL AS OTHER_PCP_LAST_VISIT_DATE,
            NULL AS OTHER_PCP_NO_OF_VISITS,
            NULL AS SPECIALIST_LAST_VISIT_DATE,
            NULL AS SPECIALIST_NO_OF_VISITS,
            NULL AS MEMBER_STREET,
            NULL AS MEMBER_CITY,
            NULL AS MEMBER_STATE,
            NULL AS MEMBER_ZIP_CODE,
            NULL AS PROVIDER_STREET,
            NULL AS PROVIDER_CITY,
            NULL AS PROVIDER_STATE,
            NULL AS PROVIDER_ZIP_CODE,
            NULL AS PROVIDER_SPECIALTY,
            --NULL AS HCC_RISK_SCORE,
            --NULL AS HCC_RISK_SCORE_IND,
            NULL AS ER_VISITS,
            NULL AS NO_OF_REFERRALS_RCVD,
            NULL AS NO_OF_REFERRALS_SENT,
            NULL AS CHRONIC_CARE_GAP_SCORE, --EBCBS
            NULL AS CHRONIC_CARE_GAPS, --EBCBS
            NULL AS CLINICAL_DOC_OPEN_IND, --EBCBS
            NULL AS CDOI_HIGH_PRIORITY, --EBCBS
            NULL AS NEED_ANNUAL_VISIT, --EBCBS
            NULL AS HEALTH_ASSESSMENT, --EBCBS
            NULL AS IP_COST, --EBCBS
            NULL AS OP_COST, --EBCBS
            NULL AS PROF_COST, --EBCBS
            NULL AS PHARM_COST, --EBCBS
            NULL AS CONDITIONBASED_OPPORTUNITIES,  -- EBCBS
            NULL AS TOTAL_COST,
            CASE WHEN PAT.PAT_STATUS_C = '2' THEN 'EXPIRED' ELSE NULL END AS PAT_STATUS,
            NULL AS PATIENT_CLASS,--ATTRIBUTIONS
            NULL AS UNIT,--ATTRIBUTIONS
            NULL AS SERVICE, --ATTRIBUTIONS
            DAILY.IP_ADM_IN_PAST_12_MTH,
            DAILY.IP_READM_IN_PAST_12_MTH
            --FROM CIN_CIGNA_DAILY_LAST_W_PATID DAILY
            FROM CIN_CIGNA_DAILY_MV_W_PATID DAILY  --20180326 switched
            JOIN PATIENT PAT ON DAILY.PAT_ID = PAT.PAT_ID;
      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending CIN_CIGNA_DAILY_MV_W_PATID');
            COMMIT;

            insert into CIN_CIGNA_DAILY_MATCHED
            --UHC INFO
            SELECT /*+ INDEX (PATIENT PK_PATIENT) */ DISTINCT case when DAILY.HOSP_NAME like '%NYU%' then 'NYU/HJD' else 'OTHER' End as NYU_OTHER,
            DAILY.PAT_MRN_ID,
            DAILY.PAT_ID,
            NVL(DAILY.ACTION_DATE, DAILY.DATE_ADDED) AS DATE_ADDED, --wanted date patient was added to the report since they remain on the file and keep getting updated, gl 7/24/14
            UPPER(CASE WHEN PAT.PAT_LAST_NAME IS NOT NULL THEN PAT.PAT_LAST_NAME ELSE DAILY.PATIENT_LAST_NAME END),
            UPPER(CASE WHEN PAT.PAT_FIRST_NAME IS NOT NULL THEN PAT.PAT_FIRST_NAME ELSE DAILY.PATIENT_FIRST_NAME END),
            DAILY.GENDER,
            CASE WHEN PAT.BIRTH_DATE IS NOT NULL THEN TO_CHAR(PAT.BIRTH_DATE, 'MM/DD/YYYY') ELSE DAILY.BIRTHDATE END,
            DAILY.ALT_ID,
            DAILY.PHYS_PCP_NAME,
            NULL,--POD_NAME
            NULL, --SUBGROUP_LEVEL_1
            NULL, --CUSTOM_NAME
            NULL, --PRACTICE LOCATION, COMES FROM MATT
            NULL, --CIGNA PHARMACY
            NULL, --YHF
            NULL, --IPHT
            NULL, --CIGNA BEHAVIORAL
            DAILY.EMP_NAME, --ACCOUNT NAME
            DAILY.ADMITDATE,
            NULL, --NEW ENTRY ON REPORT
            NULL, --PROJECTED DISCHARGE DATE
            DAILY.DISCHARGEDATE,
            DAILY.LOS,
            DAILY.DX_PRIM||' '||DAILY.DX_DESC,
            NULL, --PROCEDURE
            NULL, --ADMISSION ACCESS TYPE
            NULL, --ADMISSION ACCESS DESCRIPTION
            NULL, --BED TYPE
            DAILY.CMDM_NAME,
            DAILY.HOSP_NAME,
            DAILY.HOSP_STATE,
            DAILY.PHYS_ATTEND_NAME,
            DAILY.READM_DAYS,
            NULL, --INITIAL REPORT DATE
            NULL, --AUTH NUMBER
            NULL, --REFERRED DATE
            NULL, --REFERRAL STATUS
            NULL, --PRIMARY DX DESC
            NULL, --CASE MANAGED BY
            NULL, --CASE ID
            NULL, --ID SOURCE
            NULL, --ON CURRENT PREVISE
            NULL, --ON CURRENT GIC
            NULL, --TOT MED IN PAST 12 MTH
            NULL, --INPAT PAST 12 MTH
            NULL, --ER VSTS PAST 12 MTH
            NULL, --OUT OF NET PAST 12 MTH
            NULL, --ER VSTS SAME DXPAST 12 MTH
            NULL, --NUM OF OFF VISITS 12 MTH
            NULL, --LAST OFFICE VISIT DATE
            NULL, --RX PAST 12 MTH
            NULL, --RX PAST 3 MTH
            NULL, --RX PAST 3 MTH 1
            NULL, --RX PAST 3 MTH 2
            NULL, --RX PAST 3 MTH 3
            NULL, --RX PAST 3 MTH 4
            NULL, --RX PAST 3 MTH 5
            NULL, --RX PAST 3 MTH 6
            NULL, --RX PAST 3 MTH 7
            NULL, --RX PAST 3 MTH 8
            NULL, --RX PAST 3 MTH 9
            NULL, --RX PAST 3 MTH 10
            NULL, --RX PAST 3 MTH 11
            NULL, --RX PAST 3 MTH 12
            DAILY.TREATMT_SETTING_SUBTYPE,
            DAILY.RST_SCORE,
            DAILY.DISP_CODE_DESC,
            DAILY.RPM_SCORE,
            NULL, --AETNA PCMH_ATTR_EFFECTIVE_DATE,
            NULL, --AETNA PULSE_SCORE,
            NULL, --AETNA AOS_SCORE,
            NULL, --AETNA MEMBER_PHONE,
            NVL(LOB, 'Commercial'), --AETNA LINE_OF_BUSINESS, new data added by UHC 4/1/2016
            NULL, --AETNA PRODUCT,
            NULL, --AETNA DEDICATED_UNIT_NAME,
            NULL, --AETNA STAY_TYPE,
            INDV_ID, --AETNA_CARD_ID, new data added by UHC 4/1/2016
            CIN_GET_CURRENT_CCC(DAILY.PAT_ID) as CURRENT_CCC,
            'UHC' AS PAYOR,
            CASE WHEN DAILY.PAT_ID NOT IN (SELECT CIN_HISTORY_DAILY_WEBI.PAT_ID FROM CIN_HISTORY_DAILY_WEBI WHERE CIN_HISTORY_DAILY_WEBI.PAYOR = 'UHC' AND DAILY.ADMITDATE=CIN_HISTORY_DAILY_WEBI.ADMIT_DATE AND DAILY.DISCHARGEDATE=CIN_HISTORY_DAILY_WEBI.ACTUAL_DISCHARGE_DATE AND DAILY.PAT_ID=CIN_HISTORY_DAILY_WEBI.PAT_ID AND (CIN_HISTORY_DAILY_WEBI.DATE_RUN) < TRUNC(SYSDATE)) THEN 'Y' --Has not been on the webi before with this payor and admit date --cant use, havent kept history long enough yet -history has been there for a while now added 3/4/16
                 WHEN SUBSTR(DAILY.ALT_ID/*PATIENT_NO*/,3) IN (SELECT MEMBER_ID FROM CIN_UHC_DAILY_PT WHERE DATE_ADDED = TRUNC(SYSDATE) AND MEMBER_ID NOT IN (SELECT PT1.MEMBER_ID FROM CIN_UHC_DAILY_PT PT1, CIN_UHC_DAILY_PT PT2 WHERE PT1.DATE_ADDED = TRUNC(SYSDATE) AND PT1.MEMBER_ID = PT2.MEMBER_ID AND PT1.CONDITION = PT2.CONDITION AND PT1.DATE_ADDED-1 = PT2.DATE_ADDED)) THEN 'Y'  --IF they qualified to make the webi today, but werent also qualified yesterday with the same condition --alt id used now as per new format on 4/6/16
                 ELSE 'N'
            END AS SEND_ONBASE_DOC,
            NULL AS AGE, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC_MONTHS, --EBCBS
            NULL AS HOT_SPOTTER_READMISSION, --EBCBS
            NULL AS RISK_DRIVERS, --EBCBS
            NULL AS INPATIENT_AUTHORIZATION, --EBCBS
            NULL AS READMISSION_RISK, --EBCBS
            NULL AS CM_PROGRAM_STATUS, --EBCBS
            NULL AS CM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS DM_PROGRAM_NAME, --EBCBS
            NULL AS DM_PROGRAM_STATUS, --EBCBS
            NULL AS DM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS NEW_ATTRIBUTION, --EBCBS
            NULL AS NPI, --EBCBS
            NULL AS MONTHS_ATTRIBUTED, --EBCBS
            NULL AS ATTRIBUTION_METHOD, --EBCBS
            NULL AS ORGANIZATION, --EBCBS
            NULL AS PROSPECTIVE_RISK_SCORE, --EBCBS
            NULL AS CARE_OPPORTUNITIES, --EBCBS
            NULL AS CONDITIONS, --EBCBS
            NULL AS CONDITION_DETAILS, --EBCBS
            NULL AS VISITS, --EBCBS
            NULL AS ATTRIBUTED_PCP_LAST_VISIT_DATE, --EBCBS
            NULL AS ATTRIBUTED_PCP_NO_OF_VISITS, --EBCBS
            NULL AS ER_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_NO_OF_VISITS, --EBCBS
            NULL AS URGENT_CARE_LAST_VISIT_DATE, --EBCBS
            NULL AS URGENT_CARE_NO_OF_VISITS, --EBCBS
            NULL AS ACUTE_READMITS_LAST_30_DAYS, --EMBLEM
            NULL AS ACUTE_ADMITS_LAST_12_MONTHS, --EMBLEM
            -- NULL AS HOT_SPOTTER_GAP_SCORE,--EBCBS
            NULL AS CMDM_CONTACT_NAME_PRI,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_PRI,--EBCBS
            NULL AS CMDM_CONTACT_NAME_SEC,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_SEC,--EBCBS
            NULL AS IHM_CARE_COORD_EMPLOYER,--EBCBS
            NULL AS INPATIENT_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_NO_OF_VISITS,--EBCBS
            NULL AS SPECIALIST_LAST_VISIT_DATE,--EBCBS
            NULL AS SPECIALIST_NO_OF_VISITS,--EBCBS
            NULL AS MEMBER_STREET,--EBCBS
            NULL AS MEMBER_CITY,--EBCBS
            NULL AS MEMBER_STATE,--EBCBS
            NULL AS MEMBER_ZIP_CODE,--EBCBS
            NULL AS PROVIDER_STREET,--EBCBS
            NULL AS PROVIDER_CITY,--EBCBS
            NULL AS PROVIDER_STATE,--EBCBS
            NULL AS PROVIDER_ZIP_CODE,--EBCBS
            NULL AS PROVIDER_SPECIALTY,--EBCBS
            --NULL AS HCC_RISK_SCORE,--EBCBS
            --NULL AS HCC_RISK_SCORE_IND,--EBCBS
            NULL AS ER_VISITS,--EBCBS
            NULL AS NO_OF_REFERRALS_RCVD,--EBCBS
            NULL AS NO_OF_REFERRALS_SENT,--EBCBS
            NULL AS CHRONIC_CARE_GAP_SCORE, --EBCBS
            NULL AS CHRONIC_CARE_GAPS, --EBCBS
            NULL AS CLINICAL_DOC_OPEN_IND, --EBCBS
            NULL AS CDOI_HIGH_PRIORITY,--EBCBS
            NULL AS NEED_ANNUAL_VISIT,--EBCBS
            NULL AS HEALTH_ASSESSMENT,--EBCBS
            NULL AS IP_COST,--EBCBS
            NULL AS OP_COST,--EBCBS
            NULL AS PROF_COST,--EBCBS
            NULL AS PHARM_COST, --EBCBS
            NULL AS CONDITIONBASED_OPPORTUNITIES,  -- EBCBS
            NULL AS TOTAL_COST,
            CASE WHEN PAT.PAT_STATUS_C = '2' THEN 'EXPIRED' ELSE NULL END AS PAT_STATUS,
            NULL AS PATIENT_CLASS,--ATTRIBUTIONS
            NULL AS UNIT,--ATTRIBUTIONS
            NULL AS SERVICE, --ATTRIBUTIONS
            NULL AS IP_ADM_IN_PAST_12_MTH,
            NULL AS IP_READM_IN_PAST_12_MTH
            FROM CIN_UHC_DAILY_MV_W_PATID DAILY
            JOIN PATIENT PAT ON DAILY.PAT_ID = PAT.PAT_ID;
      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending CIN_UHC_DAILY_MV_W_PATID');
            COMMIT;

            insert into CIN_CIGNA_DAILY_MATCHED
            --OHP INFO
            SELECT /*+ INDEX (PATIENT PK_PATIENT) */ DISTINCT case when DAILY.HOSP_NAME like '%NYU%' then 'NYU/HJD' else 'OTHER' End as NYU_OTHER,
            DAILY.PAT_MRN_ID,
            DAILY.PAT_ID,
            NVL(DAILY.ACTION_DATE, DAILY.DATE_ADDED) AS DATE_ADDED,
            UPPER(CASE WHEN PAT.PAT_LAST_NAME IS NOT NULL THEN PAT.PAT_LAST_NAME ELSE DAILY.PATIENT_LAST_NAME END),
            UPPER(CASE WHEN PAT.PAT_FIRST_NAME IS NOT NULL THEN PAT.PAT_FIRST_NAME ELSE DAILY.PATIENT_FIRST_NAME END),
            DAILY.GENDER,
            CASE WHEN PAT.BIRTH_DATE IS NOT NULL THEN PAT.BIRTH_DATE ELSE TO_DATE(DAILY.BIRTHDATE, 'yyyy-mm-dd') END, -- SELECT * FROM CIN_OHP_DAILY_MV_W_PATID
            DAILY.PATIENT_NO, --CIGNA ID FIELD
            DAILY.PHYS_PCP_NAME, --ALIGNED DR NAME FIELD
            NULL,--POD_NAME
            NULL, --SUBGROUP_LEVLE_1
            NULL, --CUSTOM_NAME
            NULL, --PRACTICE LOCATION, COMES FROM MATT
            NULL, --CIGNA PHARMACY
            NULL, --YHF
            NULL, --IPHT
            NULL, --CIGNA BEHAVIORAL
            NULL, --DAILY.EMP_NAME, --ACCOUNT NAME
            DAILY.ADMITDATE,
            NULL, --NEW ENTRY ON REPORT
            NULL, --PROJECTED DISCHARGE DATE
            DAILY.DISCHARGEDATE,
            DAILY.LOS,
            DAILY.DX_PRIM||' '||DAILY.DX_DESC,
            NULL, --PROCEDURE
            NULL, --ADMISSION ACCESS TYPE
            NULL, --ADMISSION ACCESS DESCRIPTION
            NULL, --BED TYPE
            NULL, --DAILY.CMDM_NAME,
            DAILY.HOSP_NAME,
            DAILY.HOSP_STATE,
            DAILY.PHYS_ATTEND_NAME,
            DAILY.READM_DAYS,
            NULL, --INITIAL REPORT DATE
            NULL, --AUTH NUMBER
            NULL, --REFERRED DATE
            NULL, --REFERRAL STATUS
            NULL, --PRIMARY DX DESC
            NULL, --CASE MANAGED BY
            NULL, --CASE ID
            NULL, --ID SOURCE
            NULL, --ON CURRENT PREVISE
            NULL, --ON CURRENT GIC
            NULL, --TOT MED IN PAST 12 MTH
            NULL, --INPAT PAST 12 MTH
            NULL, --ER VSTS PAST 12 MTH
            NULL, --OUT OF NET PAST 12 MTH
            NULL, --ER VSTS SAME DXPAST 12 MTH
            NULL, --NUM OF OFF VISITS 12 MTH
            NULL, --LAST OFFICE VISIT DATE
            NULL, --RX PAST 12 MTH
            NULL, --RX PAST 3 MTH
            NULL, --RX PAST 3 MTH 1
            NULL, --RX PAST 3 MTH 2
            NULL, --RX PAST 3 MTH 3
            NULL, --RX PAST 3 MTH 4
            NULL, --RX PAST 3 MTH 5
            NULL, --RX PAST 3 MTH 6
            NULL, --RX PAST 3 MTH 7
            NULL, --RX PAST 3 MTH 8
            NULL, --RX PAST 3 MTH 9
            NULL, --RX PAST 3 MTH 10
            NULL, --RX PAST 3 MTH 11
            NULL, --RX PAST 3 MTH 12
            DAILY.TREATMT_SETTING_SUBTYPE,
            DAILY.RST_SCORE,
            DAILY.DISP_CODE_DESC,
            DAILY.RPM_SCORE,
            NULL, --AETNA PCMH_ATTR_EFFECTIVE_DATE,
            NULL, --AETNA PULSE_SCORE,
            NULL, --AETNA AOS_SCORE,
            NULL, --AETNA MEMBER_PHONE,
            NVL(DAILY.LOB,'Commercial'), --'Commercial', --AETNA LINE_OF_BUSINESS,
            NULL, --AETNA PRODUCT,
            NULL, --AETNA DEDICATED_UNIT_NAME,
            NULL, --AETNA STAY_TYPE,
            NULL, --AETNA_CARD_ID,
            CIN_GET_CURRENT_CCC(DAILY.PAT_ID) as CURRENT_CCC,
            'OHP' AS PAYOR,
            CASE WHEN DAILY.PAT_ID NOT IN (SELECT CIN_HISTORY_DAILY_WEBI.PAT_ID FROM CIN_HISTORY_DAILY_WEBI WHERE CIN_HISTORY_DAILY_WEBI.PAYOR = 'OHP' AND DAILY.ADMITDATE=CIN_HISTORY_DAILY_WEBI.ADMIT_DATE AND DAILY.DISCHARGEDATE=CIN_HISTORY_DAILY_WEBI.ACTUAL_DISCHARGE_DATE AND DAILY.PAT_ID=CIN_HISTORY_DAILY_WEBI.PAT_ID AND (CIN_HISTORY_DAILY_WEBI.DATE_RUN) < TRUNC(SYSDATE)) THEN 'Y' --Has not been on the webi before with this payor and admit date --cant use, havent kept history long enough yet -history has been there for a while now added 3/4/16
                 WHEN DAILY.PATIENT_NO/*MEMBER_ID*/ IN (SELECT MEMBER_ID FROM CIN_OHP_DAILY_PT WHERE (DATE_ADDED) >= TRUNC(SYSDATE) AND MEMBER_ID NOT IN (SELECT PT1.MEMBER_ID FROM CIN_OHP_DAILY_PT PT1, CIN_OHP_DAILY_PT PT2 WHERE PT1.DATE_ADDED = TRUNC(SYSDATE) AND PT1.MEMBER_ID = PT2.MEMBER_ID AND PT1.CONDITION = PT2.CONDITION AND PT1.DATE_ADDED-1 = PT2.DATE_ADDED)) THEN 'Y'  --IF they qualified to make the webi today, but werent also qualified yesterday with the same condition
                 ELSE 'N'
            END AS SEND_ONBASE_DOC,
            NULL AS AGE, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC_MONTHS, --EBCBS
            NULL AS HOT_SPOTTER_READMISSION, --EBCBS
            NULL AS RISK_DRIVERS, --EBCBS
            NULL AS INPATIENT_AUTHORIZATION, --EBCBS
            NULL AS READMISSION_RISK, --EBCBS
            NULL AS CM_PROGRAM_STATUS, --EBCBS
            NULL AS CM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS DM_PROGRAM_NAME, --EBCBS
            NULL AS DM_PROGRAM_STATUS, --EBCBS
            NULL AS DM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS NEW_ATTRIBUTION, --EBCBS
            NULL AS NPI, --EBCBS
            NULL AS MONTHS_ATTRIBUTED, --EBCBS
            NULL AS ATTRIBUTION_METHOD, --EBCBS
            NULL AS ORGANIZATION, --EBCBS
            NULL AS PROSPECTIVE_RISK_SCORE, --EBCBS
            NULL AS CARE_OPPORTUNITIES, --EBCBS
            NULL AS CONDITIONS, --EBCBS
            NULL AS CONDITION_DETAILS, --EBCBS
            NULL AS VISITS, --EBCBS
            NULL AS ATTRIBUTED_PCP_LAST_VISIT_DATE, --EBCBS
            NULL AS ATTRIBUTED_PCP_NO_OF_VISITS, --EBCBS
            NULL AS ER_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_NO_OF_VISITS, --EBCBS
            NULL AS URGENT_CARE_LAST_VISIT_DATE, --EBCBS
            NULL AS URGENT_CARE_NO_OF_VISITS, --EBCBS
            NULL AS ACUTE_READMITS_LAST_30_DAYS, --EMBLEM
            NULL AS ACUTE_ADMITS_LAST_12_MONTHS, --EMBLEM
            -- NULL AS HOT_SPOTTER_GAP_SCORE,--EBCBS
            NULL AS CMDM_CONTACT_NAME_PRI,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_PRI,--EBCBS
            NULL AS CMDM_CONTACT_NAME_SEC,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_SEC,--EBCBS
            NULL AS IHM_CARE_COORD_EMPLOYER,--EBCBS
            NULL AS INPATIENT_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_NO_OF_VISITS,--EBCBS
            NULL AS SPECIALIST_LAST_VISIT_DATE,--EBCBS
            NULL AS SPECIALIST_NO_OF_VISITS,--EBCBS
            NULL AS MEMBER_STREET,--EBCBS
            NULL AS MEMBER_CITY,--EBCBS
            NULL AS MEMBER_STATE,--EBCBS
            NULL AS MEMBER_ZIP_CODE,--EBCBS
            NULL AS PROVIDER_STREET,--EBCBS
            NULL AS PROVIDER_CITY,--EBCBS
            NULL AS PROVIDER_STATE,--EBCBS
            NULL AS PROVIDER_ZIP_CODE,--EBCBS
            NULL AS PROVIDER_SPECIALTY,--EBCBS
            --NULL AS HCC_RISK_SCORE,--EBCBS
            --NULL AS HCC_RISK_SCORE_IND,--EBCBS
            NULL AS ER_VISITS,--EBCBS
            NULL AS NO_OF_REFERRALS_RCVD,--EBCBS
            NULL AS NO_OF_REFERRALS_SENT,--EBCBS
            NULL AS CHRONIC_CARE_GAP_SCORE, --EBCBS
            NULL AS CHRONIC_CARE_GAPS, --EBCBS
            NULL AS CLINICAL_DOC_OPEN_IND, --EBCBS
            NULL AS CDOI_HIGH_PRIORITY,--EBCBS
            NULL AS NEED_ANNUAL_VISIT,--EBCBS
            NULL AS HEALTH_ASSESSMENT,--EBCBS
            NULL AS IP_COST,--EBCBS
            NULL AS OP_COST,--EBCBS
            NULL AS PROF_COST,--EBCBS
            NULL AS PHARM_COST, --EBCBS
            NULL AS CONDITIONBASED_OPPORTUNITIES,  -- EBCBS
            NULL AS TOTAL_COST,
            CASE WHEN PAT.PAT_STATUS_C = '2' THEN 'EXPIRED' ELSE NULL END AS PAT_STATUS,
            NULL AS PATIENT_CLASS,--ATTRIBUTIONS
            NULL AS UNIT,--ATTRIBUTIONS
            NULL AS SERVICE, --ATTRIBUTIONS
            NULL AS IP_ADM_IN_PAST_12_MTH,
            NULL AS IP_READM_IN_PAST_12_MTH
            FROM CIN_OHP_DAILY_MV_W_PATID DAILY
            JOIN PATIENT PAT ON DAILY.PAT_ID = PAT.PAT_ID;

      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending CIN_OHP_DAILY_MV_W_PATID');
            COMMIT;

            insert into CIN_CIGNA_DAILY_MATCHED
            --AETNA INFO
            SELECT /*+ INDEX (PATIENT PK_PATIENT) */ DISTINCT case when DAILY.FACILITY_NAME_ROLE like '%NYU%' then 'NYU/HJD' else 'OTHER' End as NYU_OTHER,
            DAILY.PAT_MRN_ID,
            DAILY.PAT_ID,
            NVL(DAILY.ACTION_DATE, DAILY.DATE_ADDED) AS DATE_ADDED,
            UPPER(CASE WHEN PAT.PAT_LAST_NAME IS NOT NULL THEN PAT.PAT_LAST_NAME ELSE DAILY.MEMBER_LAST_NAME END),
            UPPER(CASE WHEN PAT.PAT_FIRST_NAME IS NOT NULL THEN PAT.PAT_FIRST_NAME ELSE DAILY.MEMBER_FIRST_NAME END),
            CASE WHEN PAT.SEX_C = 1 THEN 'F' WHEN PAT.SEX_C = 2 THEN 'M' ELSE 'Unknown' END AS GENDER, --GENDER,
            CASE WHEN PAT.BIRTH_DATE IS NOT NULL THEN TO_CHAR(PAT.BIRTH_DATE, 'MM/DD/YYYY') ELSE TO_CHAR(TO_DATE(DAILY.DATE_OF_BIRTH, 'YYYY-MM-DD'), 'MM/DD/YYYY') END AS BIRTHDATE,
            DAILY.CUMB_ID, --CIGNA ID FIELD
            UPPER(DAILY.PCMH_ATTR_PROVIDER_NAME), --DAILY.PROVIDER_NAME_ROLE, --ALIGNED DR NAME FIELD
            NULL,--POD_NAME
            NULL, --SUBGROUP_LEVLE_1
            NULL, --CUSTOM_NAME
            NULL, --PRACTICE LOCATION, COMES FROM MATT
            NULL, --CIGNA PHARMACY
            NULL, --YHF
            NULL, --IPHT
            NULL, --CIGNA BEHAVIORAL
            DAILY.PLAN_SPONSOR_NAME, --EMP_NAME, --ACCOUNT NAME
            DAILY.ACTUAL_ADMIT_DATE,
            DAILY.STATUS, --NEW ENTRY ON REPORT
            DAILY.EXPECTED_DISCHARGE_DATE, --PROJECTED DISCHARGE DATE
            DAILY.ACTUAL_DISCHARGE_DATE,
            NULL, --LOS,
            DAILY.DIAGNOSIS_CODE||' '||DAILY.DIAGNOSIS_DESCRIPTION,
            DAILY.PROCEDURE_CODE||' '||DAILY.PROCEDURE_DESCRIPTION, --PROCEDURE
            DAILY.ADMISSION_TYPE, --ADMISSION ACCESS TYPE
            NULL, --ADMISSION ACCESS DESCRIPTION
            NULL, --BED TYPE
            NULL, --DAILY.CMDM_NAME,
            DAILY.FACILITY_NAME_ROLE,
            DAILY.CONTROLLING_STATE,
            DAILY.PROVIDER_NAME_ROLE,
            NULL, --DAILY.READM_DAYS,
            NULL, --INITIAL REPORT DATE
            NULL, --AUTH NUMBER
            NULL, --REFERRED DATE
            NULL, --REFERRAL STATUS
            NULL, --PRIMARY DX DESC
            NULL, --CASE MANAGED BY
            NULL, --CASE ID
            NULL, --ID SOURCE
            NULL, --ON CURRENT PREVISE
            NULL, --ON CURRENT GIC
            NULL, --TOT MED IN PAST 12 MTH
            NULL, --INPAT PAST 12 MTH
            NULL, --ER VSTS PAST 12 MTH
            NULL, --OUT OF NET PAST 12 MTH
            NULL, --ER VSTS SAME DXPAST 12 MTH
            NULL, --NUM OF OFF VISITS 12 MTH
            NULL, --LAST OFFICE VISIT DATE
            NULL, --RX PAST 12 MTH
            NULL, --RX PAST 3 MTH
            NULL, --RX PAST 3 MTH 1
            NULL, --RX PAST 3 MTH 2
            NULL, --RX PAST 3 MTH 3
            NULL, --RX PAST 3 MTH 4
            NULL, --RX PAST 3 MTH 5
            NULL, --RX PAST 3 MTH 6
            NULL, --RX PAST 3 MTH 7
            NULL, --RX PAST 3 MTH 8
            NULL, --RX PAST 3 MTH 9
            NULL, --RX PAST 3 MTH 10
            NULL, --RX PAST 3 MTH 11
            NULL, --RX PAST 3 MTH 12
            DAILY.EVENT_TYPE, --TREATMT_SETTING_SUBTYPE,
            NULL, --RST_SCORE,
            NULL, --DISP_CODE_DESC,
            NULL, --RPM_SCORE,
            TO_CHAR(TO_DATE(DAILY.PCMH_ATTR_EFFECTIVE_DATE, 'YYYY-MM-DD'), 'MM/DD/YYYY') ,
            DAILY.PULSE_SCORE,
            DAILY.AOS_SCORE,
            DAILY.MEMBER_PHONE,
            DAILY.LINE_OF_BUSINESS,
            DAILY.PRODUCT,
            DAILY.DEDICATED_UNIT_NAME,
            DAILY.STAY_TYPE,
            DAILY.CARD_ID AS AETNA_CARD_ID,
            CIN_GET_CURRENT_CCC(DAILY.PAT_ID) as CURRENT_CCC,
            'AETNA' AS PAYOR,
            CASE WHEN DAILY.PAT_ID NOT IN (SELECT CIN_HISTORY_DAILY_WEBI.PAT_ID FROM CIN_HISTORY_DAILY_WEBI WHERE CIN_HISTORY_DAILY_WEBI.PAYOR = 'AETNA' AND DAILY.ACTUAL_ADMIT_DATE=CIN_HISTORY_DAILY_WEBI.ADMIT_DATE AND DAILY.ACTUAL_DISCHARGE_DATE=CIN_HISTORY_DAILY_WEBI.ACTUAL_DISCHARGE_DATE AND DAILY.PAT_ID=CIN_HISTORY_DAILY_WEBI.PAT_ID AND (CIN_HISTORY_DAILY_WEBI.DATE_RUN) < TRUNC(SYSDATE)) THEN 'Y' --Has not been on the webi before with this payor and admit date --cant use, havent kept history long enough yet -history has been there for a while now added 3/4/16
                 WHEN DAILY.CUMB_ID IN (SELECT CUMB_ID FROM CIN_AETNA_DAILY_PT WHERE DATE_ADDED = TRUNC(SYSDATE) AND CUMB_ID NOT IN (SELECT PT1.CUMB_ID FROM CIN_AETNA_DAILY_PT PT1, CIN_AETNA_DAILY_PT PT2 WHERE PT1.DATE_ADDED = TRUNC(SYSDATE) AND PT1.CUMB_ID = PT2.CUMB_ID AND PT1.BIRTH_DATE = PT2.BIRTH_DATE AND PT1.CONDITION = PT2.CONDITION AND PT1.DATE_ADDED-1 = PT2.DATE_ADDED)) THEN 'Y' --IF they qualified to make the webi today, but werent also qualified yesterday with the same condition
                 ELSE 'N'
            END AS SEND_ONBASE_DOC,
            NULL AS AGE, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC_MONTHS, --EBCBS
            NULL AS HOT_SPOTTER_READMISSION, --EBCBS
            NULL AS RISK_DRIVERS, --EBCBS
            NULL AS INPATIENT_AUTHORIZATION, --EBCBS
            NULL AS READMISSION_RISK, --EBCBS
            NULL AS CM_PROGRAM_STATUS, --EBCBS
            NULL AS CM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS DM_PROGRAM_NAME, --EBCBS
            NULL AS DM_PROGRAM_STATUS, --EBCBS
            NULL AS DM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS NEW_ATTRIBUTION, --EBCBS
            NULL AS NPI, --EBCBS
            NULL AS MONTHS_ATTRIBUTED, --EBCBS
            NULL AS ATTRIBUTION_METHOD, --EBCBS
            NULL AS ORGANIZATION, --EBCBS
            NULL AS PROSPECTIVE_RISK_SCORE, --EBCBS
            NULL AS CARE_OPPORTUNITIES, --EBCBS
            NULL AS CONDITIONS, --EBCBS
            NULL AS CONDITION_DETAILS, --EBCBS
            NULL AS VISITS, --EBCBS
            NULL AS ATTRIBUTED_PCP_LAST_VISIT_DATE, --EBCBS
            NULL AS ATTRIBUTED_PCP_NO_OF_VISITS, --EBCBS
            NULL AS ER_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_NO_OF_VISITS, --EBCBS
            NULL AS URGENT_CARE_LAST_VISIT_DATE, --EBCBS
            NULL AS URGENT_CARE_NO_OF_VISITS, --EBCBS
            NULL AS ACUTE_READMITS_LAST_30_DAYS, --EMBLEM
            NULL AS ACUTE_ADMITS_LAST_12_MONTHS, --EMBLEM
            --NULL AS HOT_SPOTTER_GAP_SCORE,--EBCBS
            NULL AS CMDM_CONTACT_NAME_PRI,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_PRI,--EBCBS
            NULL AS CMDM_CONTACT_NAME_SEC,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_SEC,--EBCBS
            NULL AS IHM_CARE_COORD_EMPLOYER,--EBCBS
            NULL AS INPATIENT_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_NO_OF_VISITS,--EBCBS
            NULL AS SPECIALIST_LAST_VISIT_DATE,--EBCBS
            NULL AS SPECIALIST_NO_OF_VISITS,--EBCBS
            NULL AS MEMBER_STREET,--EBCBS
            NULL AS MEMBER_CITY,--EBCBS
            NULL AS MEMBER_STATE,--EBCBS
            NULL AS MEMBER_ZIP_CODE,--EBCBS
            NULL AS PROVIDER_STREET,--EBCBS
            NULL AS PROVIDER_CITY,--EBCBS
            NULL AS PROVIDER_STATE,--EBCBS
            NULL AS PROVIDER_ZIP_CODE,--EBCBS
            NULL AS PROVIDER_SPECIALTY,--EBCBS
            --NULL AS HCC_RISK_SCORE,--EBCBS
            --NULL AS HCC_RISK_SCORE_IND,--EBCBS
            NULL AS ER_VISITS,--EBCBS
            NULL AS NO_OF_REFERRALS_RCVD,--EBCBS
            NULL AS NO_OF_REFERRALS_SENT,--EBCBS
            NULL AS CHRONIC_CARE_GAP_SCORE, --EBCBS
            NULL AS CHRONIC_CARE_GAPS, --EBCBS
            NULL AS CLINICAL_DOC_OPEN_IND, --EBCBS
            NULL AS CDOI_HIGH_PRIORITY,--EBCBS
            NULL AS NEED_ANNUAL_VISIT,--EBCBS
            NULL AS HEALTH_ASSESSMENT,--EBCBS
            NULL AS IP_COST,--EBCBS
            NULL AS OP_COST,--EBCBS
            NULL AS PROF_COST,--EBCBS
            NULL AS PHARM_COST, --EBCBS
            NULL AS CONDITIONBASED_OPPORTUNITIES,  -- EBCBS
            NULL AS TOTAL_COST,
            CASE WHEN PAT.PAT_STATUS_C = '2' THEN 'EXPIRED' ELSE NULL END AS PAT_STATUS,
            NULL AS PATIENT_CLASS,--ATTRIBUTIONS
            NULL AS UNIT,--ATTRIBUTIONS
            NULL AS SERVICE, --ATTRIBUTIONS
            NULL AS IP_ADM_IN_PAST_12_MTH,
            NULL AS IP_READM_IN_PAST_12_MTH
            FROM CIN_AETNA_DAILY_MV_W_PATID DAILY
            JOIN PATIENT PAT ON DAILY.PAT_ID = PAT.PAT_ID;

      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending CIN_AETNA_DAILY_MV_W_PATID');
            COMMIT;

            insert into CIN_CIGNA_DAILY_MATCHED
            --EBCBS INFO
            SELECT /*+ INDEX (PATIENT PK_PATIENT) */ DISTINCT case when DAILY.INPATIENT_FACILITY like '%NYU%' then 'NYU/HJD' else 'OTHER' End as NYU_OTHER,
            DAILY.PAT_MRN_ID,
            DAILY.PAT_ID,
            NVL(DAILY.ACTION_DATE, DAILY.DATE_ADDED) AS DATE_ADDED,
            UPPER(CASE WHEN PAT.PAT_LAST_NAME IS NOT NULL THEN PAT.PAT_LAST_NAME ELSE DAILY.PATIENT_LAST_NAME END),
            UPPER(CASE WHEN PAT.PAT_FIRST_NAME IS NOT NULL THEN PAT.PAT_FIRST_NAME ELSE DAILY.PATIENT_FIRST_NAME END),
            DAILY.GENDER,
            CASE WHEN PAT.BIRTH_DATE IS NOT NULL THEN TO_CHAR(PAT.BIRTH_DATE, 'MM/DD/YYYY') ELSE DAILY.DOB END,
            DAILY.MEMBER_ID, --CIGNA ID FIELD
            DAILY.ATTRIBUTED_PROVIDER, --ALIGNED DR NAME FIELD
            NULL,--POD_NAME
            NULL, --SUBGROUP_LEVLE_1
            NULL, --CUSTOM_NAME
            NULL, --PRACTICE LOCATION, COMES FROM MATT
            NULL, --CIGNA PHARMACY
            NULL, --YHF
            NULL, --IPHT
            NULL, --CIGNA BEHAVIORAL
            NULL, --EMP_NAME, --ACCOUNT NAME
            DAILY.ADMISSION_DATE, --ADMIT_DATE
            NULL, --NEW ENTRY ON REPORT
            NULL, --PROJECTED DISCHARGE DATE
            DAILY.DISCHARGE_DATE,
            DAILY.LENGTH_OF_STAY,
            DAILY.ADMITTING_DIAGNOSIS,
            NULL, --PROCEDURE
            NULL, --ADMISSION ACCESS TYPE
            NULL, --ADMISSION ACCESS DESCRIPTION
            NULL, --BED TYPE
            DAILY.CM_PROGRAM_NAME, --CMDM_NAME,--CASE_MANAGEMENT_PROGRAM
            DAILY.INPATIENT_FACILITY, --FACILITY
            NULL, --HOSP_STATE,
            NULL, --PHYS_ATTEND_NAME,
            NULL, --READM_DAYS,
            NULL, --INITIAL REPORT DATE
            NULL, --AUTH NUMBER
            NULL, --REFERRED DATE
            NULL, --REFERRAL STATUS
            NULL, --PRIMARY DX DESC
            NULL, --CASE MANAGED BY
            NULL, --CASE ID
            NULL, --ID SOURCE
            NULL, --ON CURRENT PREVISE
            NULL, --ON CURRENT GIC
            NULL, --TOT MED IN PAST 12 MTH
            NULL, --INPAT PAST 12 MTH
            DAILY.ER_NO_OF_VISITS, --ER VSTS PAST 12 MTH
            NULL, --OUT OF NET PAST 12 MTH
            NULL, --ER VSTS SAME DXPAST 12 MTH
            DAILY.OUTPATIENT_NO_OF_VISITS, --NUM OF OFF VISITS 12 MTH
            DAILY.OUTPATIENT_LAST_VISIT_DATE, --LAST OFFICE VISIT DATE
            NULL, --RX PAST 12 MTH
            NULL, --RX PAST 3 MTH
            NULL, --RX PAST 3 MTH 1
            NULL, --RX PAST 3 MTH 2
            NULL, --RX PAST 3 MTH 3
            NULL, --RX PAST 3 MTH 4
            NULL, --RX PAST 3 MTH 5
            NULL, --RX PAST 3 MTH 6
            NULL, --RX PAST 3 MTH 7
            NULL, --RX PAST 3 MTH 8
            NULL, --RX PAST 3 MTH 9
            NULL, --RX PAST 3 MTH 10
            NULL, --RX PAST 3 MTH 11
            NULL, --RX PAST 3 MTH 12
            NULL, --TREATMT_SETTING_SUBTYPE,
            NULL, --RST_SCORE,
            NULL, --DISP_CODE_DESC,
            NULL, --RPM_SCORE,
            DAILY.ATTRIBUTION_DATE, --AETNA PCMH_ATTR_EFFECTIVE_DATE,
            NULL, --AETNA PULSE_SCORE,
            NULL, --AETNA AOS_SCORE,
            DAILY.PHONE_NUMBER, --AETNA MEMBER_PHONE,
            CASE WHEN DAILY.LINE_OF_BUSINESS = 'Medicare' THEN 'Medicare Advantage' ELSE DAILY.LINE_OF_BUSINESS END AS LINE_OF_BUSINESS, --AETNA LINE_OF_BUSINESS,
            DAILY.PRODUCT, --AETNA PRODUCT,
            NULL, --AETNA DEDICATED_UNIT_NAME,
            NULL, --AETNA STAY_TYPE,
            NULL, --AETNA_CARD_ID,
            CIN_GET_CURRENT_CCC(DAILY.PAT_ID) as CURRENT_CCC,
            DAILY.PAYER AS PAYOR,
            CASE WHEN DAILY.PAT_ID NOT IN (SELECT CIN_HISTORY_DAILY_WEBI.PAT_ID FROM CIN_HISTORY_DAILY_WEBI WHERE CIN_HISTORY_DAILY_WEBI.PAYOR = DAILY.PAYER AND DAILY.ADMISSION_DATE=CIN_HISTORY_DAILY_WEBI.ADMIT_DATE AND DAILY.DISCHARGE_DATE=CIN_HISTORY_DAILY_WEBI.ACTUAL_DISCHARGE_DATE AND DAILY.PAT_ID=CIN_HISTORY_DAILY_WEBI.PAT_ID AND (CIN_HISTORY_DAILY_WEBI.DATE_RUN) < TRUNC(SYSDATE)) THEN 'Y' --Has not been on the webi before with this payor and admit date --cant use, havent kept history long enough yet -history has been there for a while now added 3/4/16
                 WHEN DAILY.MEMBER_ID IN (SELECT MEMBER_ID FROM CIN_EBCBS_DAILY_PT WHERE DATE_ADDED = TRUNC(SYSDATE) AND MEMBER_ID NOT IN (SELECT PT1.MEMBER_ID FROM CIN_EBCBS_DAILY_PT PT1, CIN_EBCBS_DAILY_PT PT2 WHERE PT1.DATE_ADDED = TRUNC(SYSDATE) AND PT1.MEMBER_ID = PT2.MEMBER_ID AND PT1.CONDITION = PT2.CONDITION AND PT1.DATE_ADDED-1 = PT2.DATE_ADDED)) THEN 'Y'  --IF they qualified to make the webi today, but werent also qualified yesterday with the same condition
                 ELSE 'N'
            END AS SEND_ONBASE_DOC,
            DAILY.AGE, --EBCBS
            DAILY.HOT_SPOTTER_CHRONIC, --EBCBS
            DAILY.MONTHS_AS_HOT_SPOTTER_CHRONIC,--DAILY.HOT_SPOTTER_CHRONIC_MONTHS, --EBCBS
            DAILY.HOT_SPOTTER_READMISSION, --EBCBS
            DAILY.RISK_DRIVERS, --EBCBS
            DAILY.INPATIENT_AUTHORIZATION, --EBCBS
            DAILY.READMISSION_RISK, --EBCBS
            DAILY.CM_PROGRAM_STATUS, --EBCBS
            DAILY.CM_PROGRAM_STATUS_REASON, --EBCBS
            DAILY.DM_PROGRAM_NAME, --EBCBS
            DAILY.DM_PROGRAM_STATUS, --EBCBS
            DAILY.DM_PROGRAM_STATUS_REASON, --EBCBS
            DAILY.NEW_ATTRIBUTION, --EBCBS
            DAILY.PROVIDER_NPI, --EBCBS
            DAILY.MONTHS_ATTRIBUTED, --EBCBS
            DAILY.ATTRIBUTION_METHOD, --EBCBS
            DAILY.ORGANIZATION, --EBCBS
            DAILY.PROSPECTIVE_RISK_SCORE, --EBCBS
            DAILY.CARE_OPPORTUNITIES, --EBCBS
            DAILY.CONDITIONS, --EBCBS
            DAILY.CONDITION_DETAILS, --EBCBS
            DAILY.VISITS, --EBCBS
            DAILY.ATTR_PROVIDER_LAST_VISIT,--DAILY.ATTRIBUTED_PCP_LAST_VISIT_DATE, --EBCBS
            DAILY.ATTR_PROVIDER_NO_OF_VIS,--DAILY.ATTRIBUTED_PCP_NO_OF_VISITS, --EBCBS
            DAILY.ER_LAST_VISIT_DATE, --EBCBS
            DAILY.INPATIENT_LAST_VISIT_DATE, --EBCBS
            DAILY.INPATIENT_NO_OF_VISITS, --EBCBS
            DAILY.URGENT_CARE_LAST_VISIT_DATE, --EBCBS
            DAILY.URGENT_CARE_NO_OF_VISITS, --EBCBS
            NULL AS ACUTE_READMITS_LAST_30_DAYS, --EMBLEM
            NULL AS ACUTE_ADMITS_LAST_12_MONTHS, --EMBLEM
            --HOT_SPOTTER_GAP_SCORE,--EBCBS
            CMDM_CONTACT_NAMEPRIM,--EBCBS
            CMDM_CONTACT_PHONE_NUMBERPRIM,--EBCBS
            CMDM_CONTACT_NAMESEC,--EBCBS
            CMDM_CONTACT_PHONE_NUMBERSEC,--EBCBS
            IHM_CARE_COORD_EMP_GRP,--EBCBS
            OUTPATIENT_LAST_VISIT_DATE,--EBCBS
            OTHER_PCP_LAST_VISIT_DATE,--EBCBS
            OTHER_PCP_NO_OF_VISITS,--EBCBS
            SPECIALIST_LAST_VISIT_DATE,--EBCBS
            SPECIALIST_NO_OF_VISITS,--EBCBS
            MEMBER_STREET,--EBCBS
            MEMBER_CITY,--EBCBS
            MEMBER_STATE,--EBCBS
            MEMBER_ZIP_CODE,--EBCBS
            PROVIDER_STREET,--EBCBS
            PROVIDER_CITY,--EBCBS
            PROVIDER_STATE,--EBCBS
            PROVIDER_ZIP_CODE,--EBCBS
            PROVIDER_SPECIALTY,--EBCBS
            --HCC_RISK_SCORE,--EBCBS
            --HCC_RISK_SCORE_IND,--EBCBS
            ER_VISITS,--EBCBS
            NO_OF_REFERRALS_RECEIVED,--EBCBS
            NO_OF_REFERRALS_SENT,--EBCBS
            DAILY.CHRONIC_CARE_GAP_SCORE, --EBCBS
            DAILY.CHRONIC_CARE_GAPS, --EBCBS
            DAILY.CLINICAL_DOC_OPEN_IND, --EBCBS
            DAILY.CDOI_HIGH_PRIORITY,--EBCBS
            DAILY.NEED_ANNUAL_VISIT,--EBCBS
            DAILY.HEALTH_ASSESSMENT,--EBCBS
            DAILY.IP_COST,--EBCBS
            DAILY.OP_COST,--EBCBS
            DAILY.PROF_COST,--EBCBS
            DAILY.PHARM_COST, --EBCBS
            NULL AS CONDITIONBASED_OPPORTUNITIES,  -- EBCBS
            NULL AS TOTAL_COST,
            CASE WHEN PAT.PAT_STATUS_C = '2' THEN 'EXPIRED' ELSE NULL END AS PAT_STATUS,
            NULL AS PATIENT_CLASS,--ATTRIBUTIONS
            NULL AS UNIT,--ATTRIBUTIONS
            NULL AS SERVICE, --ATTRIBUTIONS
            NULL AS IP_ADM_IN_PAST_12_MTH,
            NULL AS IP_READM_IN_PAST_12_MTH
            FROM CIN_EBCBS_DAILY_MV_W_PATID DAILY
            JOIN PATIENT PAT ON DAILY.PAT_ID = PAT.PAT_ID;

      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending CIN_EBCBS_DAILY_MV_W_PATID');
            COMMIT;

            insert into CIN_CIGNA_DAILY_MATCHED
            --AETNAMA INFO
            SELECT /*+ INDEX (PATIENT PK_PATIENT) */ DISTINCT case when DAILY.FACILITY_NAME like '%NYU%' then 'NYU/HJD' else 'OTHER' End as NYU_OTHER,
            DAILY.PAT_MRN_ID,
            DAILY.PAT_ID,
            NVL(DAILY.ACTION_DATE, DAILY.DATE_ADDED) AS DATE_ADDED,
            UPPER(CASE WHEN PAT.PAT_LAST_NAME IS NOT NULL THEN PAT.PAT_LAST_NAME ELSE DAILY.LAST_NAME END),
            UPPER(CASE WHEN PAT.PAT_FIRST_NAME IS NOT NULL THEN PAT.PAT_FIRST_NAME ELSE DAILY.FIRST_NAME END),
            CASE WHEN PAT.SEX_C = 1 THEN 'F' WHEN PAT.SEX_C = 2 THEN 'M' ELSE 'Unknown' END AS GENDER, --GENDER, FILE DOESNT HAVE GENDER SO USE EPIC
            --CASE WHEN PAT.BIRTH_DATE IS NOT NULL THEN TO_CHAR(PAT.BIRTH_DATE, 'MM/DD/YYYY') ELSE DAILY.DOB END AS DOB,  source date format changed
            CASE WHEN PAT.BIRTH_DATE IS NOT NULL THEN TO_CHAR(PAT.BIRTH_DATE, 'MM/DD/YYYY') ELSE TO_CHAR(TO_DATE(DAILY.DOB, 'YYYY-MM-DD'), 'MM/DD/YYYY') END AS DOB,
            DAILY.MEMBER_ID, --CIGNA ID FIELD
            DAILY.PHYSICIAN_NAME, --ALIGNED DR NAME FIELD
            NULL,--POD_NAME
            NULL, --SUBGROUP_LEVLE_1
            NULL, --CUSTOM_NAME
            NULL, --PRACTICE LOCATION, COMES FROM MATT
            NULL, --CIGNA PHARMACY
            NULL, --YHF
            NULL, --IPHT
            NULL, --CIGNA BEHAVIORAL
            DAILY.PLAN_SPONSOR, --EMP_NAME, --ACCOUNT NAME
            DAILY.ADMISSION_DATE, --ADMIT_DATE
            NULL, --NEW ENTRY ON REPORT
            --NULL, --PROJECTED DISCHARGE DATE
            DAILY.EXPECTED_DISCHARGE_DATE, --PROJECTED DISCHARGE DATE  added 20180611 SC
            DAILY.DISCHARGE_DATE,
            DAILY.LOS, --LOS
            DAILY.DIAGNOSIS_CODE, --DAILY.ICD||' '||DAILY.ICD_DESC AS DX, 20180611 SC
            DAILY.PROCEDURE_CODE, --PROCEDURE 20180611 by SC
            DAILY.ADMISSION_TYPE, --ADMISSION ACCESS TYPE
            NULL, --ADMISSION ACCESS DESCRIPTION
            NULL, --BED TYPE
            NULL, --CMDM_NAME,--CASE_MANAGEMENT_PROGRAM
            DAILY.FACILITY_NAME, --FACILITY
            DAILY.FACILITY_STATE, --FACILITY_STATE,
            NULL, --ADMITTING_PROVIDER,
            NULL, --READMISSION,
            NULL, --INITIAL REPORT DATE
            NULL, --AUTH NUMBER
            NULL, --REFERRED DATE
            NULL, --REFERRAL STATUS
            DAILY.DIAGNOSIS_DESCRIPTION, --PRIMARY DX DESC 20180611
            NULL, --CASE MANAGED BY
            NULL, --CASE ID
            NULL, --ID SOURCE
            NULL, --ON CURRENT PREVISE
            NULL, --ON CURRENT GIC
            NULL, --TOT MED IN PAST 12 MTH
            NULL, --INPAT PAST 12 MTH
            NULL, --ER VSTS PAST 12 MTH
            NULL, --OUT OF NET PAST 12 MTH
            NULL, --ER VSTS SAME DXPAST 12 MTH
            NULL, --NUM OF OFF VISITS 12 MTH
            NULL, --LAST OFFICE VISIT DATE
            NULL, --RX PAST 12 MTH
            NULL, --RX PAST 3 MTH
            NULL, --RX PAST 3 MTH 1
            NULL, --RX PAST 3 MTH 2
            NULL, --RX PAST 3 MTH 3
            NULL, --RX PAST 3 MTH 4
            NULL, --RX PAST 3 MTH 5
            NULL, --RX PAST 3 MTH 6
            NULL, --RX PAST 3 MTH 7
            NULL, --RX PAST 3 MTH 8
            NULL, --RX PAST 3 MTH 9
            NULL, --RX PAST 3 MTH 10
            NULL, --RX PAST 3 MTH 11
            NULL, --RX PAST 3 MTH 12
            NULL, --TREATMT_SETTING_SUBTYPE,
            NULL, --RST_SCORE,
            DAILY.DISCHARGE_DISPOSITION, --DISP_CODE_DESC,
            NULL, --RPM_SCORE,
            NULL, --AETNA PCMH_ATTR_EFFECTIVE_DATE,
            DAILY.PULSE_SCORE, --AETNA PULSE_SCORE,
            NULL, --AETNA AOS_SCORE,
            DAILY.PHONE_NUMBER, --AETNA MEMBER_PHONE,
            DAILY.LINE_OF_BUSINESS, --AETNA LINE_OF_BUSINESS,
            DAILY.PRODUCT, --AETNA PRODUCT,
            NULL, --AETNA DEDICATED_UNIT_NAME,
            DAILY.STAY_TYPE, --AETNA STAY_TYPE,
            DAILY.MEMBER_ID, --AETNA_CARD_ID,
            CIN_GET_CURRENT_CCC(DAILY.PAT_ID) as CURRENT_CCC,
            DAILY.PAYER AS PAYOR,
            CASE WHEN DAILY.PAT_ID NOT IN (SELECT CIN_HISTORY_DAILY_WEBI.PAT_ID FROM CIN_HISTORY_DAILY_WEBI WHERE CIN_HISTORY_DAILY_WEBI.PAYOR = DAILY.PAYER AND DAILY.ADMISSION_DATE=CIN_HISTORY_DAILY_WEBI.ADMIT_DATE AND DAILY.DISCHARGE_DATE=CIN_HISTORY_DAILY_WEBI.ACTUAL_DISCHARGE_DATE AND DAILY.PAT_ID=CIN_HISTORY_DAILY_WEBI.PAT_ID AND (CIN_HISTORY_DAILY_WEBI.DATE_RUN) < TRUNC(SYSDATE)) THEN 'Y' --Has not been on the webi before with this payor and admit date --cant use, havent kept history long enough yet -history has been there for a while now added 3/4/16
                 WHEN DAILY.MEMBER_ID IN (SELECT MEMBER_ID FROM CIN_AETNAMA_DAILY_PT WHERE DATE_ADDED = TRUNC(SYSDATE) AND MEMBER_ID NOT IN (SELECT PT1.MEMBER_ID FROM CIN_AETNAMA_DAILY_PT PT1, CIN_AETNAMA_DAILY_PT PT2 WHERE PT1.DATE_ADDED = TRUNC(SYSDATE) AND PT1.MEMBER_ID = PT2.MEMBER_ID AND PT1.CONDITION = PT2.CONDITION AND PT1.DATE_ADDED-1 = PT2.DATE_ADDED)) THEN 'Y'  --IF they qualified to make the webi today, but werent also qualified yesterday with the same condition
                 ELSE 'N'
            END AS SEND_ONBASE_DOC,
            NULL AS AGE, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC_MONTHS, --EBCBS
            NULL AS HOT_SPOTTER_READMISSION, --EBCBS
            NULL AS RISK_DRIVERS, --EBCBS
            NULL AS INPATIENT_AUTHORIZATION, --EBCBS
            NULL AS READMISSION_RISK, --EBCBS
            NULL AS CM_PROGRAM_STATUS, --EBCBS
            NULL AS CM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS DM_PROGRAM_NAME, --EBCBS
            NULL AS DM_PROGRAM_STATUS, --EBCBS
            NULL AS DM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS NEW_ATTRIBUTION, --EBCBS
            DAILY.PHYSICIAN_NUMBER AS NPI, --EBCBS
            NULL AS MONTHS_ATTRIBUTED, --EBCBS
            NULL AS ATTRIBUTION_METHOD, --EBCBS
            NULL AS ORGANIZATION, --EBCBS
            NULL AS PROSPECTIVE_RISK_SCORE, --EBCBS
            NULL AS CARE_OPPORTUNITIES, --EBCBS
            NULL AS CONDITIONS, --EBCBS
            NULL AS CONDITION_DETAILS, --EBCBS
            NULL AS VISITS, --EBCBS
            NULL AS ATTRIBUTED_PCP_LAST_VISIT_DATE, --EBCBS
            NULL AS ATTRIBUTED_PCP_NO_OF_VISITS, --EBCBS
            NULL AS ER_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_NO_OF_VISITS, --EBCBS
            NULL AS URGENT_CARE_LAST_VISIT_DATE, --EBCBS
            NULL AS URGENT_CARE_NO_OF_VISITS, --EBCBS
            NULL AS ACUTE_READMITS_LAST_30_DAYS, --EMBLEM
            NULL AS ACUTE_ADMITS_LAST_12_MONTHS, --EMBLEM
            --NULL AS HOT_SPOTTER_GAP_SCORE,--EBCBS
            NULL AS CMDM_CONTACT_NAME_PRI,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_PRI,--EBCBS
            NULL AS CMDM_CONTACT_NAME_SEC,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_SEC,--EBCBS
            NULL AS IHM_CARE_COORD_EMPLOYER,--EBCBS
            NULL AS OUTPATIENT_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_NO_OF_VISITS,--EBCBS
            NULL AS SPECIALIST_LAST_VISIT_DATE,--EBCBS
            NULL AS SPECIALIST_NO_OF_VISITS,--EBCBS
            NULL AS MEMBER_STREET, --EBCBS
            NULL AS MEMBER_CITY, --EBCBS
            NULL AS MEMBER_STATE,--EBCBS
            NULL AS MEMBER_ZIP_CODE,--EBCBS
            DAILY.ACO_ATTR_PROV_ADDRESS1,  --PROVIDER_STREET
            DAILY.ACO_ATTR_PROV_CITY,  -- PROVIDER_CITY
            DAILY.ACO_ATTR_PROV_STATE, --PROVIDER_STATE
            DAILY.ACO_ATTR_PROV_ZIPCODE,    --PROVIDER_ZIP_CODE
            NULL AS PROVIDER_SPECIALTY,--EBCBS
            --NULL AS HCC_RISK_SCORE,--EBCBS
            --NULL AS HCC_RISK_SCORE_IND,--EBCBS
            NULL AS ER_VISITS,--EBCBS
            NULL AS NO_OF_REFERRALS_RCVD,--EBCBS
            NULL AS NO_OF_REFERRALS_SENT,--EBCBS
            NULL AS CHRONIC_CARE_GAP_SCORE, --EBCBS
            NULL AS CHRONIC_CARE_GAPS, --EBCBS
            NULL AS CLINICAL_DOC_OPEN_IND, --EBCBS
            NULL AS CDOI_HIGH_PRIORITY,--EBCBS
            NULL AS NEED_ANNUAL_VISIT,--EBCBS
            NULL AS HEALTH_ASSESSMENT,--EBCBS
            NULL AS IP_COST,--EBCBS
            NULL AS OP_COST,--EBCBS
            NULL AS PROF_COST,--EBCBS
            NULL AS PHARM_COST, --EBCBS
            NULL AS CONDITIONBASED_OPPORTUNITIES,  -- EBCBS
            NULL AS TOTAL_COST,
            CASE WHEN PAT.PAT_STATUS_C = '2' THEN 'EXPIRED' ELSE NULL END AS PAT_STATUS,
            NULL AS PATIENT_CLASS,
            NULL AS UNIT,
            NULL AS SERVICE,
            NULL AS IP_ADM_IN_PAST_12_MTH,
            NULL AS IP_READM_IN_PAST_12_MTH
            FROM CIN_AETNAMA_DAILY_MV_W_PATID DAILY
            JOIN PATIENT PAT ON DAILY.PAT_ID = PAT.PAT_ID;

      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending CIN_AETNAMA_DAILY_MV_W_PATID');
            COMMIT;

            insert into CIN_CIGNA_DAILY_MATCHED
            --HEALTHPMC INFO added 6/20/2017
            SELECT /*+ INDEX (PATIENT PK_PATIENT) */ DISTINCT case when DAILY.INPATIENT_FACILITY like '%NYU%' then 'NYU/HJD' else 'OTHER' End as NYU_OTHER,
            DAILY.PAT_MRN_ID,
            DAILY.PAT_ID,
            NVL(DAILY.ACTION_DATE, DAILY.DATE_ADDED) AS DATE_ADDED,
            UPPER(CASE WHEN PAT.PAT_LAST_NAME IS NOT NULL THEN PAT.PAT_LAST_NAME ELSE DAILY.LAST_NAME END),
            UPPER(CASE WHEN PAT.PAT_FIRST_NAME IS NOT NULL THEN PAT.PAT_FIRST_NAME ELSE DAILY.FIRST_NAME END),
            --DAILY.GENDER,
            CASE WHEN DAILY.GENDER IS NOT NULL THEN DAILY.GENDER WHEN PAT.SEX_C = 1 THEN 'F' WHEN PAT.SEX_C = 2 THEN 'M' ELSE 'Unknown' END AS GENDER, --TABLE WAS BLANK WITH GENDER SO PULLING FROM EPIC IF NULL FROM HEALTHPLS TABLE gl 7/6/17
            CASE WHEN PAT.BIRTH_DATE IS NOT NULL THEN TO_CHAR(PAT.BIRTH_DATE, 'MM/DD/YYYY') ELSE DAILY.DOB END,
            DAILY.MEMBER_ID, --CIGNA ID FIELD
            DAILY.ATTRIBUTED_PROVIDER, --ALIGNED DR NAME FIELD
            NULL,--POD_NAME
            NULL, --SUBGROUP_LEVLE_1
            NULL, --CUSTOM_NAME
            NULL, --PRACTICE LOCATION, COMES FROM MATT
            NULL, --CIGNA PHARMACY
            NULL, --YHF
            NULL, --IPHT
            NULL, --CIGNA BEHAVIORAL
            NULL, --EMP_NAME, --ACCOUNT NAME
            DAILY.ADMISSION_DATE, --ADMIT_DATE
            NULL, --NEW ENTRY ON REPORT
            NULL, --PROJECTED DISCHARGE DATE
            DAILY.DISCHARGE_DATE,
            DAILY.LENGTH_OF_STAY,
            DAILY.ADMITTING_DIAGNOSIS,
            NULL, --PROCEDURE
            NULL, --ADMISSION ACCESS TYPE
            NULL, --ADMISSION ACCESS DESCRIPTION
            NULL, --BED TYPE
            DAILY.CM_PROGRAM_NAME, --CMDM_NAME,--CASE_MANAGEMENT_PROGRAM
            DAILY.INPATIENT_FACILITY, --FACILITY
            NULL, --HOSP_STATE,
            NULL, --PHYS_ATTEND_NAME,
            NULL, --READM_DAYS,
            NULL, --INITIAL REPORT DATE
            NULL, --AUTH NUMBER
            NULL, --REFERRED DATE
            NULL, --REFERRAL STATUS
            NULL, --PRIMARY DX DESC
            NULL, --CASE MANAGED BY
            NULL, --CASE ID
            NULL, --ID SOURCE
            NULL, --ON CURRENT PREVISE
            NULL, --ON CURRENT GIC
            NULL, --TOT MED IN PAST 12 MTH
            NULL, --INPAT PAST 12 MTH
            DAILY.ER_NO_OF_VISITS, --ER VSTS PAST 12 MTH
            NULL, --OUT OF NET PAST 12 MTH
            NULL, --ER VSTS SAME DXPAST 12 MTH
            DAILY.OUTPATIENT_NO_OF_VISITS, --NUM OF OFF VISITS 12 MTH
            DAILY.OUTPATIENT_LAST_VISIT_DATE, --LAST OFFICE VISIT DATE
            NULL, --RX PAST 12 MTH
            NULL, --RX PAST 3 MTH
            NULL, --RX PAST 3 MTH 1
            NULL, --RX PAST 3 MTH 2
            NULL, --RX PAST 3 MTH 3
            NULL, --RX PAST 3 MTH 4
            NULL, --RX PAST 3 MTH 5
            NULL, --RX PAST 3 MTH 6
            NULL, --RX PAST 3 MTH 7
            NULL, --RX PAST 3 MTH 8
            NULL, --RX PAST 3 MTH 9
            NULL, --RX PAST 3 MTH 10
            NULL, --RX PAST 3 MTH 11
            NULL, --RX PAST 3 MTH 12
            NULL, --TREATMT_SETTING_SUBTYPE,
            NULL, --RST_SCORE,
            NULL, --DISP_CODE_DESC,
            NULL, --RPM_SCORE,
            DAILY.ATTRIBUTION_DATE, --AETNA PCMH_ATTR_EFFECTIVE_DATE,
            NULL, --AETNA PULSE_SCORE,
            NULL, --AETNA AOS_SCORE,
            DAILY.PHONE_NUMBER, --AETNA MEMBER_PHONE,
            CASE WHEN DAILY.LINE_OF_BUSINESS = 'Medicare' THEN 'Medicare Advantage' ELSE DAILY.LINE_OF_BUSINESS END AS LINE_OF_BUSINESS, --AETNA LINE_OF_BUSINESS,
            DAILY.PRODUCT, --AETNA PRODUCT,
            NULL, --AETNA DEDICATED_UNIT_NAME,
            NULL, --AETNA STAY_TYPE,
            NULL, --AETNA_CARD_ID,
            CIN_GET_CURRENT_CCC(DAILY.PAT_ID) as CURRENT_CCC,
            DAILY.PAYER AS PAYOR,
            CASE WHEN DAILY.PAT_ID NOT IN (SELECT CIN_HISTORY_DAILY_WEBI.PAT_ID FROM CIN_HISTORY_DAILY_WEBI WHERE CIN_HISTORY_DAILY_WEBI.PAYOR = DAILY.PAYER AND DAILY.ADMISSION_DATE=CIN_HISTORY_DAILY_WEBI.ADMIT_DATE AND DAILY.DISCHARGE_DATE=CIN_HISTORY_DAILY_WEBI.ACTUAL_DISCHARGE_DATE AND DAILY.PAT_ID=CIN_HISTORY_DAILY_WEBI.PAT_ID AND (CIN_HISTORY_DAILY_WEBI.DATE_RUN) < TRUNC(SYSDATE)) THEN 'Y' --Has not been on the webi before with this payor and admit date --cant use, havent kept history long enough yet -history has been there for a while now added 3/4/16
                 WHEN DAILY.MEMBER_ID IN (SELECT MEMBER_ID FROM CIN_HEALTHPMC_DAILY_PT WHERE DATE_ADDED = TRUNC(SYSDATE) AND MEMBER_ID NOT IN (SELECT PT1.MEMBER_ID FROM CIN_HEALTHPMC_DAILY_PT PT1, CIN_HEALTHPMC_DAILY_PT PT2 WHERE PT1.DATE_ADDED = TRUNC(SYSDATE) AND PT1.MEMBER_ID = PT2.MEMBER_ID AND PT1.CONDITION = PT2.CONDITION AND PT1.DATE_ADDED-1 = PT2.DATE_ADDED)) THEN 'Y'  --IF they qualified to make the webi today, but werent also qualified yesterday with the same condition
                 ELSE 'N'
            END AS SEND_ONBASE_DOC,
            DAILY.AGE, --EBCBS
            DAILY.HOT_SPOTTER_CHRONIC, --EBCBS
            DAILY.MONTHS_AS_HOT_SPTR_CHRONIC,--DAILY.HOT_SPOTTER_CHRONIC_MONTHS, --EBCBS
            DAILY.HOT_SPOTTER_READMISSION, --EBCBS
            DAILY.RISK_DRIVERS, --EBCBS
            DAILY.INPATIENT_AUTHORIZATION, --EBCBS
            DAILY.READMISSION_RISK, --EBCBS
            DAILY.CM_PROGRAM_STATUS, --EBCBS
            DAILY.CM_PROGRAM_STATUS_REASON, --EBCBS
            DAILY.DM_PROGRAM_NAME, --EBCBS
            DAILY.DM_PROGRAM_STATUS, --EBCBS
            DAILY.DM_PROGRAM_STATUS_REASON, --EBCBS
            DAILY.NEW_ATTRIBUTION, --EBCBS
            DAILY.NPI, --EBCBS
            DAILY.MONTHS_ATTRIBUTED, --EBCBS
            DAILY.ATTRIBUTION_METHOD, --EBCBS
            DAILY.ORGANIZATION, --EBCBS
            DAILY.PROSPECTIVE_RISK_SCORE, --EBCBS
            DAILY.CARE_OPPORTUNITIES, --EBCBS
            DAILY.CONDITIONS, --EBCBS
            DAILY.CONDITION_DETAILS, --EBCBS
            DAILY.VISITS, --EBCBS
            DAILY.ATTR_PROVIDER_LAST_VISIT,--DAILY.ATTRIBUTED_PCP_LAST_VISIT_DATE, --EBCBS
            DAILY.ATTR_PROVIDER_NO_OF_VIS,--DAILY.ATTRIBUTED_PCP_NO_OF_VISITS, --EBCBS
            DAILY.ER_LAST_VISIT_DATE, --EBCBS
            DAILY.INPATIENT_LAST_VISIT_DATE, --EBCBS
            DAILY.INPATIENT_NO_OF_VISITS, --EBCBS
            DAILY.URGENT_CARE_LAST_VISIT_DATE, --EBCBS
            DAILY.URGENT_CARE_NO_OF_VISITS, --EBCBS
            NULL AS ACUTE_READMITS_LAST_30_DAYS, --EMBLEM
            NULL AS ACUTE_ADMITS_LAST_12_MONTHS, --EMBLEM
            --NULL AS HOT_SPOTTER_GAP_SCORE,--EBCBS
            CMDM_CONTACT_NAME_PRI,--EBCBS
            CMDM_CONTACT_PHONE_NO_PRI,--EBCBS
            CMDM_CONTACT_NAME_SEC,--EBCBS
            CMDM_CONTACT_PHONE_NO_SEC,--EBCBS
            IHM_CARE_COORD_EMPLOYER,--EBCBS
            OUTPATIENT_LAST_VISIT_DATE,--EBCBS
            OTHER_PCP_LAST_VISIT_DATE,--EBCBS
            OTHER_PCP_NO_OF_VISITS,--EBCBS
            SPECIALIST_LAST_VISIT_DATE,--EBCBS
            SPECIALIST_NO_OF_VISITS,--EBCBS
            MEMBER_STREET,--EBCBS
            MEMBER_CITY,--EBCBS
            MEMBER_STATE,--EBCBS
            MEMBER_ZIP_CODE,--EBCBS
            PROVIDER_STREET,--EBCBS
            PROVIDER_CITY,--EBCBS
            PROVIDER_STATE,--EBCBS
            PROVIDER_ZIP_CODE,--EBCBS
            PROVIDER_SPECIALTY,--EBCBS
            --NULL AS HCC_RISK_SCORE,--EBCBS
            --NULL AS HCC_RISK_SCORE_IND,--EBCBS
            ER_VISITS,--EBCBS
            NO_OF_REFERRALS_RCVD,--EBCBS
            NO_OF_REFERRALS_SENT,--EBCBS
            DAILY.CHRONIC_CARE_GAP_SCORE, --EBCBS
            DAILY.CHRONIC_CARE_GAPS, --EBCBS
            NULL AS CLINICAL_DOC_OPEN_IND, --EBCBS
            NULL AS CDOI_HIGH_PRIORITY,--EBCBS
            NULL AS NEED_ANNUAL_VISIT,--EBCBS
            NULL AS HEALTH_ASSESSMENT,--EBCBS
            NULL AS IP_COST,--EBCBS
            NULL AS OP_COST,--EBCBS
            NULL AS PROF_COST,--EBCBS
            NULL AS PHARM_COST, --EBCBS
           NULL AS CONDITIONBASED_OPPORTUNITIES,  -- EBCBS
            NULL AS TOTAL_COST,
            CASE WHEN PAT.PAT_STATUS_C = '2' THEN 'EXPIRED' ELSE NULL END AS PAT_STATUS,
            NULL AS PATIENT_CLASS,--ATTRIBUTIONS
            NULL AS UNIT,--ATTRIBUTIONS
            NULL AS SERVICE, --ATTRIBUTIONS
            NULL AS IP_ADM_IN_PAST_12_MTH,
            NULL AS IP_READM_IN_PAST_12_MTH
            FROM CIN_HEALTHPMC_DAILY_MV_WPATI DAILY
            JOIN PATIENT PAT ON DAILY.PAT_ID = PAT.PAT_ID;

      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending CIN_HEALTHPMC_DAILY_MV_WPATI');
            COMMIT;

            insert into CIN_CIGNA_DAILY_MATCHED
            --THIS IS TO PULL PATIENTS THAT WERE ADDED FROM THE ATTRIBUTION FILE METHOD
            SELECT /*+ INDEX (PATIENT PK_PATIENT) */ DISTINCT 'NYU/HJD' as NYU_OTHER,
            DAILY.PAT_MRN_ID,
            DAILY.PAT_ID,
            DAILY.TIME_RUN, --DATE_ADDED,
            DAILY.PAT_LAST_NAME, --PATIENT_LAST_NAME,
            DAILY.PAT_FIRST_NAME, --PATIENT_FIRST_NAME,
            CASE WHEN PAT.SEX_C = 1 THEN 'F' WHEN PAT.SEX_C = 2 THEN 'M' ELSE 'Unknown' END AS GENDER, --GENDER,
            TO_CHAR(DAILY.BIRTH_DATE, 'MM/DD/YYYY'),
            DAILY.PAYOR_ID, -- --CIGNA ID FIELD
            DAILY.ATTR_PCP_CACTUS_NAME, -- --ALIGNED DR NAME FIELD
            NULL,--POD_NAME
            DAILY.ATTR_PCP_PRACTICE,--SUBGROUP_LEVEL_1
            NULL, --CUSTOM_NAME
            DAILY.ATTR_PCP_PRACTICE_DETAIL, --PRACTICE LOCATION, COMES FROM MATT
            NULL, --CIGNA PHARMACY
            NULL, --YHF
            NULL, --IPHT
            NULL, --CIGNA BEHAVIORAL
            NULL, --DAILY.EMP_NAME, --ACCOUNT NAME
            TO_CHAR(DAILY.HOSP_ADMSN_TIME, 'MM/DD/YYYY'), --DAILY.ADMITDATE,
            NULL, --NEW ENTRY ON REPORT
            NULL, --PROJECTED DISCHARGE DATE
            TO_CHAR(DAILY.HOSP_DISCH_TIME, 'MM/DD/YYYY'), --DAILY.DISCHARGEDATE,
            TO_CHAR(DAILY.LOS), --DAILY.LOS,
            DAILY.ADMIT_DX_CODE||' '||DAILY.ADMIT_DX_NAME, --DAILY.DX_PRIM||' '||DAILY.DX_DESC,
            DAILY.PROC_NAME, --PROCEDURE
            NULL, --ADMISSION ACCESS TYPE
            NULL, --ADMISSION ACCESS DESCRIPTION
            NULL, --BED TYPE
            NULL, --CMDM_NAME,
            'NYU/HJD' AS FACILITY, --.HOSP_NAME,
            NULL, --HOSP_STATE,
            NULL, --PHYS_ATTEND_NAME,
            NULL, --READM_DAYS,
            NULL, --INITIAL REPORT DATE
            NULL, --AUTH NUMBER
            NULL, --REFERRED DATE
            NULL, --REFERRAL STATUS
            NULL, --PRIMARY DX DESC
            NULL, --CASE MANAGED BY
            NULL, --CASE ID
            NULL, --ID SOURCE
            NULL, --ON CURRENT PREVISE
            NULL, --ON CURRENT GIC
            NULL, --TOT MED IN PAST 12 MTH
            NULL, --INPAT PAST 12 MTH
            NULL, --ER VSTS PAST 12 MTH
            NULL, --OUT OF NET PAST 12 MTH
            NULL, --ER VSTS SAME DXPAST 12 MTH
            NULL, --NUM OF OFF VISITS 12 MTH
            NULL, --LAST OFFICE VISIT DATE
            NULL, --RX PAST 12 MTH
            NULL, --RX PAST 3 MTH
            NULL, --RX PAST 3 MTH 1
            NULL, --RX PAST 3 MTH 2
            NULL, --RX PAST 3 MTH 3
            NULL, --RX PAST 3 MTH 4
            NULL, --RX PAST 3 MTH 5
            NULL, --RX PAST 3 MTH 6
            NULL, --RX PAST 3 MTH 7
            NULL, --RX PAST 3 MTH 8
            NULL, --RX PAST 3 MTH 9
            NULL, --RX PAST 3 MTH 10
            NULL, --RX PAST 3 MTH 11
            NULL, --RX PAST 3 MTH 12
            NULL, --TREATMT_SETTING_SUBTYPE,
            NULL, --RST_SCORE,
            NULL, --DISP_CODE_DESC,
            NULL, --RPM_SCORE,
            NULL, --AETNA PCMH_ATTR_EFFECTIVE_DATE,
            NULL, --AETNA PULSE_SCORE,
            NULL, --AETNA AOS_SCORE,
            NULL, --AETNA MEMBER_PHONE,
            DAILY.LINE_OF_BUSINESS, --AETNA LINE_OF_BUSINESS,
            NULL, --AETNA PRODUCT,
            NULL, --AETNA DEDICATED_UNIT_NAME,
            NULL, --AETNA STAY_TYPE,
            NULL, --AETNA_CARD_ID,
            CIN_GET_CURRENT_CCC(DAILY.PAT_ID) , --CURRENT_CCC,
            DAILY.PAYER AS PAYOR,
            'N' AS SEND_ONBASE_DOC,--Dont send the onbase document currently as per christine 4/20/16
            TO_CHAR(DAILY.AGE_AT_ADMISSION) AS AGE, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC, --EBCBS
            NULL AS HOT_SPOTTER_CHRONIC_MONTHS, --EBCBS
            NULL AS HOT_SPOTTER_READMISSION, --EBCBS
            NULL AS RISK_DRIVERS, --EBCBS
            NULL AS INPATIENT_AUTHORIZATION, --EBCBS
            NULL AS READMISSION_RISK, --EBCBS
            NULL AS CM_PROGRAM_STATUS, --EBCBS
            NULL AS CM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS DM_PROGRAM_NAME, --EBCBS
            NULL AS DM_PROGRAM_STATUS, --EBCBS
            NULL AS DM_PROGRAM_STATUS_REASON, --EBCBS
            NULL AS NEW_ATTRIBUTION, --EBCBS
            DAILY.ATTR_PCP_NPI AS NPI, --EBCBS
            NULL AS MONTHS_ATTRIBUTED, --EBCBS
            NULL AS ATTRIBUTION_METHOD, --EBCBS
            NULL AS ORGANIZATION, --EBCBS
            DAILY.OPTUM_FUTURE_COST_RISK AS PROSPECTIVE_RISK_SCORE, --EBCBS
            NULL AS CARE_OPPORTUNITIES, --EBCBS
            NULL AS CONDITIONS, --EBCBS
            NULL AS CONDITION_DETAILS, --EBCBS
            NULL AS VISITS, --EBCBS
            NULL AS ATTRIBUTED_PCP_LAST_VISIT_DATE, --EBCBS
            NULL AS ATTRIBUTED_PCP_NO_OF_VISITS, --EBCBS
            NULL AS ER_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_LAST_VISIT_DATE, --EBCBS
            NULL AS INPATIENT_NO_OF_VISITS, --EBCBS
            NULL AS URGENT_CARE_LAST_VISIT_DATE, --EBCBS
            NULL AS URGENT_CARE_NO_OF_VISITS, --EBCBS
            NULL AS ACUTE_READMITS_LAST_30_DAYS, --EMBLEM
            NULL AS ACUTE_ADMITS_LAST_12_MONTHS, --EMBLEM
            --NULL AS HOT_SPOTTER_GAP_SCORE,--EBCBS
            NULL AS CMDM_CONTACT_NAME_PRI,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_PRI,--EBCBS
            NULL AS CMDM_CONTACT_NAME_SEC,--EBCBS
            NULL AS CMDM_CONTACT_PHONE_NO_SEC,--EBCBS
            NULL AS IHM_CARE_COORD_EMPLOYER,--EBCBS
            NULL AS OUTPATIENT_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_LAST_VISIT_DATE,--EBCBS
            NULL AS OTHER_PCP_NO_OF_VISITS,--EBCBS
            NULL AS SPECIALIST_LAST_VISIT_DATE,--EBCBS
            NULL AS SPECIALIST_NO_OF_VISITS,--EBCBS
            NULL AS MEMBER_STREET,--EBCBS
            NULL AS MEMBER_CITY,--EBCBS
            NULL AS MEMBER_STATE,--EBCBS
            NULL AS MEMBER_ZIP_CODE,--EBCBS
            NULL AS PROVIDER_STREET,--EBCBS
            NULL AS PROVIDER_CITY,--EBCBS
            NULL AS PROVIDER_STATE,--EBCBS
            NULL AS PROVIDER_ZIP_CODE,--EBCBS
            NULL AS PROVIDER_SPECIALTY,--EBCBS
            --NULL AS HCC_RISK_SCORE,--EBCBS
            --NULL AS HCC_RISK_SCORE_IND,--EBCBS
            NULL AS ER_VISITS,--EBCBS
            NULL AS NO_OF_REFERRALS_RCVD,--EBCBS
            NULL AS NO_OF_REFERRALS_SENT,--EBCBS
            NULL AS CHRONIC_CARE_GAP_SCORE, --EBCBS
            NULL AS CHRONIC_CARE_GAPS, --EBCBS
            NULL AS CLINICAL_DOC_OPEN_IND, --EBCBS
            NULL AS CDOI_HIGH_PRIORITY,--EBCBS
            NULL AS NEED_ANNUAL_VISIT,--EBCBS
            NULL AS HEALTH_ASSESSMENT,--EBCBS
            NULL AS IP_COST,--EBCBS
            NULL AS OP_COST,--EBCBS
            NULL AS PROF_COST,--EBCBS
            NULL AS PHARM_COST, --EBCBS
            NULL AS CONDITIONBASED_OPPORTUNITIES,  -- EBCBS
            NULL AS TOTAL_COST,
            CASE WHEN PAT.PAT_STATUS_C = '2' THEN 'EXPIRED' ELSE NULL END AS PAT_STATUS,
            DAILY.PAT_CLASS AS PATIENT_CLASS,--ATTRIBUTIONS
            DAILY.DEPARTMENT_NAME AS UNIT, --ATTRIBUTIONS
            DAILY.PAT_SERVICE AS SERVICE,  --ATTRIBUTIONS
            NULL AS IP_ADM_IN_PAST_12_MTH,
            NULL AS IP_READM_IN_PAST_12_MTH
            from CIN_ATTR_DAILY_PT DAILY
            JOIN PATIENT PAT ON DAILY.PAT_ID = PAT.PAT_ID;

      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending REPORTADMIN.CIN_ATTR_DAILY_PT');
            COMMIT;


      insert into job_status values(job_seq.nextval,'SP_CIN_CIGNA_DAILY_MATCHED', sysdate, 'ending refresh');
      COMMIT;

END SP_CIN_CIGNA_DAILY_MATCHED;
/